@page "/signIn"
@using Visitor.Data
@using Visitor.Models
@inject DatabaseHandler DbHandler
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor httpContextAccessor
@using System.Net

<h3>Sign In</h3>


<div class="row m-5">
    <div class="col-5 bg-light m-2 justify-content-start">
        <div class="p-3 mb-3 bg-primary text-white text-center">Add New Visitor</div>
        <EditForm Model="@NewVisitor">
            <div class="form-group">
                <label for="name">First Name</label>
                <input type="text" id="name" class="form-control" @bind-value="@NewVisitor.FirstName" />
            </div>
            <div class="form-group">
                <label for="name">Last Name</label>
                <input type="text" id="name" class="form-control" @bind-value="@NewVisitor.LastName" />
            </div>
            <div class="form-group">
                <label for="company">Company</label>
                <input type="text" id="company" class="form-control" @bind="@NewVisitor.Company" />
            </div>
            <div class="form-group">
                <label for="name">Contact Number</label>
                <input type="text" id="contactnumber" class="form-control" @bind-value="@NewVisitor.ContactNumber" />
            </div>
            <div class="form-group">
                <label for="name">Reason</label>
                <input type="text" id="reason" class="form-control" @bind-value="@NewVisitor.Reason" />
            </div>
            <div class="text-center p-3 mb-3">
                <button class="btn btn-info" @onclick="AddNewProduct"> Add Visitor</button>
            </div>
        </EditForm>
    </div>
</div>


@code {
    public VisitorModel NewVisitor { get; set; } = new VisitorModel();
    private async Task AddNewProduct()
    {
        string ip = httpContextAccessor.HttpContext.Connection?.RemoteIpAddress.ToString();
        if (ip == "::1")
        {
            ip =
            Dns.GetHostEntry(Dns.GetHostName()).AddressList[2].ToString();
        }

        NewVisitor.Ip_Address = ip;

        DbHandler.AddVisitor(NewVisitor);

    }


}
